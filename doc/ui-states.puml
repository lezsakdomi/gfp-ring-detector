@startuml

[*] -[dotted]-> list: Alap√©rtelmezetten\nmegny√≠lik a b√∂ng√©sz≈ëben
list --> analyze: F√°jlra kattintunk

state "F√°jlok list√°z√°sa" as list #lightBlue {
    [*] -[dotted]-> noFilter
    noFilter --> filtered
    filtered --> filtered
    state "Keres≈ëmez≈ë √ºres" as noFilter
    state "Sz≈±r≈ëfelt√©tel megadva" as filtered
}
list: Van lehet≈ës√©g keres≈ëvel sz≈±rni

state "Analiz√°l√°s" as analyze #lightBlue {
    state "F√°jl ismeretlen" as fileUnknown #lightBlue
    state "F√°jl kiv√°lasztva" as fileKnownAndAnalyzing #lightBlue {
        state "WebSocket kapcsolat l√©trehozva" as connected {
            state "1. l√©p√©s" as analyzing1 {
                state "1. l√©p√©s folyamatban" as got1inputs: Bemenetek mutat√°sa
                state "1. l√©p√©s k√©sz" as got1outputs: Kimenetek mutat√°sa
                state "Folyamat megszakadt az 1. l√©p√©sn√©l" as got1error #FFCCCB: Hiba mutat√°sa
            
                [*] -[dotted]> got1inputs: üñß
                got1inputs -[dotted]> got1outputs: üñß
                got1outputs -[dotted]> [*]: üñß
                got1inputs -[dotted]-> got1error: üñß
            }
                    
            state "2. l√©p√©s" as analyzing2 {
                state "2. l√©p√©s folyamatban" as got2inputs: Bemenetek mutat√°sa
                state "2. l√©p√©s k√©sz" as got2outputs: Kimenetek mutat√°sa
                state "Folyamat megszakadt a 2. l√©p√©sn√©l" as got2error #FFCCCB: Hiba mutat√°sa
            
                [*] -[dotted]> got2inputs: üñß
                got2inputs -[dotted]> got2outputs: üñß
                got2outputs -[dotted]> [*]: üñß
                got2inputs -[dotted]-> got2error: üñß
            }
        
            state "3. l√©p√©s" as analyzing3 {
                state "3. l√©p√©s folyamatban" as got3inputs: Bemenetek mutat√°sa
                state "3. l√©p√©s k√©sz" as got3outputs: Kimenetek mutat√°sa
                state "Folyamat megszakadt a 3. l√©p√©sn√©l" as got3error #FFCCCB: Hiba mutat√°sa
            
                [*] -[dotted]> got3inputs: üñß
                got3inputs -[dotted]> got3outputs: üñß
                got3outputs -[dotted]> [*]: üñß
                got3inputs -[dotted]-> got3error: üñß
            }
                
            [*] -[dotted]-> analyzing1: üñß
            analyzing1 -[dotted]-> analyzing2: üñß
            analyzing2 -[dotted]-> analyzing3: üñß
            analyzing3 -[dotted]-> [*]: üñß
        }
        
        state "Megszakadt a kapcsolat" as wsError #FFCCCB
        
        [*] -[dotted]-> connected
        'connected -[dotted]-> [*]: üñß
        connected -[dotted]-> wsError: üñß
    }

    fileUnknown -[dotted]-> fileKnownAndAnalyzing: F√°jln√©v bek√©r√©se\nfelugr√≥ ablakban
    [*] -[dotted]-> fileKnownAndAnalyzing

    ||

    state "F√°zis ismeretlen" as phaseUnknown #lightBlue
    state "F√°zis kiv√°lasztva" as phaseSelected #lightBlue: ""load"" / ""clean"" / stb...
    state "F√°zis √©s szekci√≥ kiv√°lasztva" as sectionSelected #lightBlue: bemenet / kimenet (als√≥ vagy fels≈ë)

    [*] -[dotted]> phaseUnknown
    phaseUnknown -[hidden]-> phaseSelected
    phaseSelected --> sectionSelected: F√ºl lenyit√°sa
    
    phaseUnknown ---> sectionSelected: F√ºl lenyit√°sa

    phaseUnknown -[dashed]--> sectionSelected: Koordin√°t√°k kiv√°laszt√°sa

    ||
    
    state "K√©pkimenet ismeretlen" as outputUnknown #lightBlue
    state "K√©pkimenet kiv√°lasztva" as outputSelected #lightBlue: DsRed / GFP / DAPI / ...
    
    [*] -[dotted]> outputUnknown
    outputUnknown --> outputSelected: F√ºl lenyit√°sa

    outputUnknown -[dashed]--> outputSelected: Koordin√°t√°k kiv√°laszt√°sa
    outputSelected -[dashed]--> outputUnknown: Koordin√°t√°k t√∂rl√©se

    --

    state "C√©lkereszt az eg√©rn√©l" as hover {
        state "K√©p teljes m√©retben" as zoomUnknown #lightBlue
        state "K√©p nagy√≠tva" as zoomSelected #lightBlue

        [*] -[dotted]> zoomUnknown
        zoomUnknown -> zoomSelected: G√∂rget√©s
        zoomSelected -> zoomSelected: G√∂rget√©s

        --

        state "K√©p a keretben" as movedUnknown
        state "K√©p elmozgatva" as movedSelected

        [*] -[dotted]> movedUnknown
        movedUnknown -> movedSelected: Arr√©bbh√∫z√°s
        movedSelected -> movedSelected: Arr√©bbh√∫z√°s

        --

        state "Koordin√°t√°k t√∂r√∂lve" as coordinatesUnknown #lightBlue
        state spacePressed <<choice>>
        state "Koordin√°t√°k kiv√°lasztva" as coordinatesSelected #lightBlue

        [*] -r-> coordinatesUnknown
        coordinatesUnknown --> coordinatesSelected: "space"
        coordinatesSelected -r-> spacePressed: "space"
        spacePressed -l-> coordinatesSelected: random helyen
        spacePressed -l-> coordinatesUnknown: ugyanott mint\naz el≈ëbb

        --

        state "V√∂r√∂s csatorna be√°ll√≠tva" as redSelected
        [*] -> redSelected: "r"
        redSelected -> redSelected: "r"

        --

        state "Z√∂ld csatorna be√°ll√≠tva" as greenSelected
        [*] -> greenSelected: "g"
        greenSelected -> greenSelected: "g"

        --

        state "K√©k csatorna be√°ll√≠tva" as lightBlueSelected
        [*] -> lightBlueSelected: "b"
        lightBlueSelected -> lightBlueSelected: "b"

        --

        state "RGB el≈ën√©zet becsukva" as compositePreviewCollapsed
        state "RGB el≈ën√©zet kinyitva" as compositePreviewOpen
        
        [*] -[dotted]> compositePreviewCollapsed
        compositePreviewCollapsed -> compositePreviewOpen: F√ºl lenyit√°sa
        compositePreviewOpen -> compositePreviewCollapsed: F√ºl becsuk√°sa
        compositePreviewCollapsed -[dashed]> compositePreviewOpen: "r" | "g" | "b"
        
        --
        
        state "V√∂r√∂s csatorna l√°that√≥" as redVisible
        state "V√∂r√∂s csatorna nem l√°that√≥" as redInvisible
        
        [*] -[dotted]> redVisible
        redVisible -> redInvisible: "shift" + "R"
        redInvisible -> redVisible: "shift" + "R"
    
        --
        
        state "Z√∂ld csatorna l√°that√≥" as greenVisible
        state "Z√∂ld csatorna nem l√°that√≥" as greenInvisible
        
        [*] -[dotted]> greenVisible
        greenVisible -> greenInvisible: "shift" + "G"
        greenInvisible -> greenVisible: "shift" + "G"
    
        --
        
        state "K√©k csatorna l√°that√≥" as lightBlueVisible
        state "K√©k csatorna nem l√°that√≥" as lightBlueInvisible
        
        [*] -[dotted]> lightBlueVisible
        lightBlueVisible -> lightBlueInvisible: "shift" + "B"
        lightBlueInvisible -> lightBlueVisible: "shift" + "B"
    }

    state "C√©lkereszt a kiv√°lasztott helyen" as noHover

    noHover --> hover: R√°vissz√ºk az\negeret egy k√©pre
    hover --> noHover: Levissz√ºk az egeret a k√©pr≈ël
}

state "T√∂bb k√©p analiz√°l√°sa" as analyzeAll {
    state "1. tal√°lat analiz√°l√°sa" as a1
    state "2. tal√°lat analiz√°l√°sa" as a2
    state "3. tal√°lat analiz√°l√°sa" as a3
    a1 --> a2
    a2 --> a3
}

list -> analyzeAll: Gombra\nkattintunk

@enduml